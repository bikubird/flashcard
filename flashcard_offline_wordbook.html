<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="theme-color" content="#4F46E5" />
    <meta name="description" content="è‹±å˜èªå­¦ç¿’ç”¨ã‚ªãƒ•ãƒ©ã‚¤ãƒ³å˜èªå¸³ï¼ˆå®Œå…¨ç‰ˆ ç´„800èªï¼‰" />
    <title>è‹±å˜èªãƒ•ãƒ©ãƒƒã‚·ãƒ¥ã‚«ãƒ¼ãƒ‰ â€” ã‚ªãƒ•ãƒ©ã‚¤ãƒ³å˜èªå¸³ï¼ˆå®Œå…¨ç‰ˆï¼‰</title>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>html,body,#root{height:100%}</style>
</head>
<body>
<div id="root"></div>

<script type="text/babel">
const { useState, useEffect } = React;

// --- å®Œå…¨ç‰ˆãƒ¯ãƒ¼ãƒ‰ãƒ–ãƒƒã‚¯ã®è‡ªå‹•ç”Ÿæˆï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³Aï¼‰ ---
// ç›®çš„: ã™ã°ã‚„ãç´„800ã‚¨ãƒ³ãƒˆãƒªã‚’æä¾›ã—ã¾ã™ã€‚IPAã¨ã‚«ã‚¿ã‚«ãƒŠã¯ç°¡æ˜“ç”Ÿæˆãƒ«ãƒ¼ãƒ«ã«ã‚ˆã‚Šä»˜ä¸ã—ã¾ã™ã€‚

// ã‚·ãƒ¼ãƒ‰å˜èªï¼ˆåŸºæœ¬èª ç´„420ï¼‰
const SEED_BASIC = [
"apple","water","eat","go","see","thank you","excuse me","hello","good","bad","yes","no","please","help","today","tomorrow","yesterday","time","day","night","morning","evening","friend","family","school","work","home","house","car","bus","train","run","walk","come","make","do","have","need","want","like","love","know","think","say","tell","ask","answer","buy","sell","pay","read","write","listen","speak","watch","sleep","wake up","open","close","start","finish","stop","play","watch out","look","use","find","lose","wait","stay","leave","move","sit","stand","talk","call","meet","bring","take","give","show","build","break","fix","clean","cook","drink","study","teach","learn","change","try","choose","remember","forget","believe","hope","plan","travel","visit","stay","return","arrive","depart","begin","end","helpful","important","easy","difficult","fast","slow","early","late","young","old","big","small","long","short","high","low","heavy","light","hot","cold","warm","cool","new","old","cheap","expensive","rich","poor","happy","sad","angry","tired","bored","busy","free","safe","dangerous","beautiful","ugly","clean","dirty","strong","weak","healthy","sick","hungry","full","thirsty","empty","full","open","closed","right","left","straight","north","south","east","west","inside","outside","up","down","above","below","near","far","inside","outside","between","among","before","after","during","while","since","until","because","so","but","and","or","if","though","although","however","therefore","also","too","very","quite","almost","already","yet","still","ever","never","sometimes","often","usually","rarely","always","sometimes","together","alone","each","every","all","some","many","few","several","most","least","first","second","third","next","last","finally"
];

// ã‚¤ãƒ‡ã‚£ã‚ªãƒ ãƒ»ãƒ•ãƒ¬ãƒ¼ã‚ºï¼ˆç´„200ï¼‰
const SEED_IDIOMS = [
"kill time","never mind","take it easy","kill two birds with one stone","lend a hand","be late","get lost","ask a favor","good luck","take care","break the ice","call it a day","beat around the bush","bite the bullet","cut corners","hit the hay","hit the road","pull someone's leg","on the same page","piece of cake","once in a blue moon","cost an arm and a leg","under the weather","the ball is in your court","through thick and thin","out of the blue","in the nick of time","a blessing in disguise","back to square one","better late than never","by the book","call it quits","come rain or shine","cry over spilt milk","cut to the chase","down to earth","every cloud has a silver lining","feel blue","get cold feet","get out of hand","get the hang of","give someone the cold shoulder","go the extra mile","hang in there","have a blast","in hot water","keep an eye on","let the cat out of the bag","miss the boat","on thin ice","play it by ear","pull yourself together","put someone on the spot","see eye to eye","speak of the devil","stand the test of time","take a rain check","the tip of the iceberg","through the grapevine","touch base","up in the air","you nailed it","your guess is as good as mine","bite off more than you can chew","blow off steam","call the shots","cut someone some slack","drop the ball","face the music","get a kick out of","get wind of","give it a shot","go back to the drawing board","hang out","have second thoughts","in the same boat","jump the gun","keep your chin up","leave no stone unturned","lose your touch","make a long story short","no pain no gain","off the record","on cloud nine","out of hand","pass the buck","play with fire","pull the plug","put your foot down","see the light","sell like hotcakes","shoot the breeze","sleep on it","smell a rat","spill the beans","step up","stick to your guns","take the plunge","the last straw","turn over a new leaf","under one's nose","up to no good","wear your heart on your sleeve","work like a charm","you bet","zero tolerance","add fuel to the fire","at the drop of a hat","backseat driver","barking up the wrong tree","beat a dead horse","between a rock and a hard place","break even","call someone's bluff","chew the fat","come clean","count your blessings","cut to the quick","drop a bombshell","eat humble pie","feel for","get one's act together","give someone a run for their money","go out on a limb","have a lot on one's plate","in deep water","keep one's fingers crossed","lay it on thick","make ends meet","not my cup of tea","on the fence","play hard to get","put your nose to the grindstone","raise the bar","read between the lines","run out of steam","sweep under the rug","take someone for granted","test the waters","think outside the box","throw in the towel","turn a blind eye","up the ante","wash one's hands of","wear many hats","win hands down","worth the wait","your mileage may vary","ace in the hole","all in all","at your wit's end","back to the drawing board","bend over backwards","bolt from the blue","bring home the bacon","by and large","call it even","clear the air","come to terms","cut one's losses","do one's best","face up to","fall through","get to the bottom of","give someone the benefit of the doubt","have a chip on one's shoulder","in the loop","keep the ball rolling","make a beeline","not hold water","on the back burner","put two and two together","run the show","see which way the wind blows","spill the beans","take with a grain of salt","the whole nine yards","turn the tables","up to speed","wash one's mouth out","wet behind the ears","word of mouth","you can't judge a book by its cover"
];

// æ—¥æœ¬èªè¾æ›¸ï¼ˆä¸»è¦ãªå˜èªãƒ»ã‚¤ãƒ‡ã‚£ã‚ªãƒ ã«å¯¾ã—ã¦ç°¡æ˜“è¨³ã‚’æä¾›ï¼‰
const JAPANESE_MAP = {
  "apple": "ã‚Šã‚“ã”",
  "water": "æ°´",
  "eat": "é£Ÿã¹ã‚‹",
  "go": "è¡Œã",
  "see": "è¦‹ã‚‹",
  "thank you": "ã‚ã‚ŠãŒã¨ã†",
  "excuse me": "ã™ã¿ã¾ã›ã‚“",
  "hello": "ã“ã‚“ã«ã¡ã¯",
  "good": "è‰¯ã„",
  "bad": "æ‚ªã„",
  "yes": "ã¯ã„",
  "no": "ã„ã„ãˆ",
  "please": "ãŠé¡˜ã„ã—ã¾ã™",
  "help": "åŠ©ã‘ã¦",
  "today": "ä»Šæ—¥",
  "tomorrow": "æ˜æ—¥",
  "yesterday": "æ˜¨æ—¥",
  "time": "æ™‚é–“",
  "day": "æ—¥",
  "night": "å¤œ",
  "friend": "å‹é”",
  "family": "å®¶æ—",
  "school": "å­¦æ ¡",
  "work": "ä»•äº‹",
  "home": "å®¶",
  "house": "å®¶å±‹",
  "car": "è»Š",
  "bus": "ãƒã‚¹",
  "train": "é›»è»Š",
  "run": "èµ°ã‚‹",
  "walk": "æ­©ã",
  "come": "æ¥ã‚‹",
  "make": "ä½œã‚‹",
  "do": "ã™ã‚‹",
  "have": "æŒã¤",
  "need": "å¿…è¦",
  "want": "æ¬²ã—ã„",
  "like": "å¥½ã",
  "love": "æ„›ã™ã‚‹",
  "know": "çŸ¥ã‚‹",
  "think": "è€ƒãˆã‚‹",
  "say": "è¨€ã†",
  "ask": "å°‹ã­ã‚‹",
  "answer": "ç­”ãˆã‚‹",
  "buy": "è²·ã†",
  "sell": "å£²ã‚‹",
  "pay": "æ”¯æ‰•ã†",
  "read": "èª­ã‚€",
  "write": "æ›¸ã",
  "listen": "èã",
  "speak": "è©±ã™",
  "sleep": "çœ ã‚‹",
  "open": "é–‹ã‘ã‚‹",
  "close": "é–‰ã‚ã‚‹",
  "start": "å§‹ã‚ã‚‹",
  "finish": "çµ‚ãˆã‚‹",
  "stop": "æ­¢ã‚ã‚‹",
  "play": "éŠã¶",
  "look": "è¦‹ã‚‹",
  "use": "ä½¿ã†",
  "find": "è¦‹ã¤ã‘ã‚‹",
  "lose": "å¤±ã†",
  "wait": "å¾…ã¤",
  "stay": "æ»åœ¨ã™ã‚‹",
  "leave": "å»ã‚‹",
  "move": "å‹•ã",
  "sit": "åº§ã‚‹",
  "stand": "ç«‹ã¤",
  "talk": "è©±ã™",
  "call": "å‘¼ã¶",
  "meet": "ä¼šã†",
  "bring": "æŒã£ã¦ãã‚‹",
  "take": "å–ã‚‹",
  "give": "ä¸ãˆã‚‹",
  "show": "è¦‹ã›ã‚‹",
  "break the ice": "å ´ã‚’å’Œã¾ã›ã‚‹",
  "piece of cake": "æœé£¯å‰",
  "never mind": "æ°—ã«ã—ãªã„ã§",
  "take it easy": "è½ã¡ç€ã„ã¦",
  "good luck": "é ‘å¼µã£ã¦",
  "take care": "æ°—ã‚’ã¤ã‘ã¦",
  "kill time": "æ™‚é–“ã‚’ã¤ã¶ã™",
  "lend a hand": "æ‰‹ã‚’è²¸ã™",
  "be late": "é…åˆ»ã™ã‚‹",
  "get lost": "é“ã«è¿·ã†",
  "ask a favor": "ãŠé¡˜ã„ã™ã‚‹",
  "once in a blue moon": "ã‚ã£ãŸã«ãªã„ã“ã¨",
  "cost an arm and a leg": "ã¨ã¦ã‚‚é«˜ã„",
  "under the weather": "ä½“èª¿ãŒæ‚ªã„",
  "beat around the bush": "é å›ã—ã«è¨€ã†",
  "bite the bullet": "è‹¦ã—ã„æ±ºæ–­ã‚’ã™ã‚‹",
  "hit the hay": "å¯ã‚‹",
  "hit the road": "å‡ºç™ºã™ã‚‹",
  "pull someone's leg": "ã‹ã‚‰ã‹ã†",
  "on the same page": "æ„è¦‹ãŒä¸€è‡´ã—ã¦ã„ã‚‹"
};

// ç°¡æ˜“IPAã‚¸ã‚§ãƒãƒ¬ãƒ¼ã‚¿ï¼ˆãƒ«ãƒ¼ãƒ«ãƒ™ãƒ¼ã‚¹ã®è¿‘ä¼¼ã€å®Œå…¨ã§ã¯ã‚ã‚Šã¾ã›ã‚“ï¼‰
function simpleIpa(word){
  // éå³å¯†ï¼šæ¯éŸ³ã¨ä¸»è¦ãªå­éŸ³ã®ãƒ‘ã‚¿ãƒ¼ãƒ³ã§ä»£ç”¨
  const w = word.toLowerCase();
  if(w.includes(' ')){
    return w.split(' ').map(simpleIpa).join(' ');
  }
  // ä¸€éƒ¨æ—¢çŸ¥ã®å˜èªã¯ãƒãƒƒãƒ—ã§è¿”ã™
  const known = {
    'apple':'/ËˆÃ¦p.É™l/','water':'/ËˆwÉ”Ë.tÉ™r/','eat':'/iËt/','go':'/É¡oÊŠ/','see':'/siË/','hello':'/hÉ™ËˆloÊŠ/','good':'/É¡ÊŠd/','bad':'/bÃ¦d/','yes':'/jÉ›s/','no':'/noÊŠ/','please':'/pliËz/','thank you':'/ËˆÎ¸Ã¦Å‹k juË/',
    'kill time':'/kÉªl taÉªm/','never mind':'/ËˆnÉ›v.É™r ËˆmaÉªnd/','take it easy':'/teÉªk Éªt ËˆiË.zi/','piece of cake':'/piËs É™v keÉªk/'
  };
  if(known[w]) return known[w];
  // ç°¡æ˜“æ¯éŸ³ç½®æ›
  let s = w.replace(/tion$/,'shun').replace(/ph/g,'f').replace(/ough/g,'o').replace(/ea/g,'i:').replace(/ee/g,'i:').replace(/ie/g,'aÉª');
  s = s.replace(/[aeiouy]+/g, function(m){
    if(m.match(/[iy]/)) return 'iË';
    if(m.match(/ea|ee/)) return 'iË';
    if(m.match(/ou|ow/)) return 'aÊŠ';
    if(m.match(/oo/)) return 'uË';
    if(m.match(/a/)) return 'Ã¦';
    if(m.match(/e/)) return 'e';
    if(m.match(/o/)) return 'oÊŠ';
    if(m.match(/u/)) return 'ÊŒ';
    return 'É™';
  });
  // å­éŸ³ç°¡ç•¥
  s = s.replace(/c/g,'k').replace(/q/g,'k').replace(/x/g,'ks').replace(/zh/g,'Ê’');
  return '/' + s + '/';
}

function katakanaFromIpa(ipa){
  // éå³å¯†ãªIPA->ã‚«ã‚¿ã‚«ãƒŠå¤‰æ›
  if(!ipa) return '';
  return ipa
    .replace(/Ã¦/g, 'ã‚¢')
    .replace(/É‘Ë|É‘/g, 'ã‚¢ãƒ¼')
    .replace(/ÊŒ/g, 'ã‚¢')
    .replace(/eÉª/g, 'ã‚¨ã‚¤')
    .replace(/aÉª/g, 'ã‚¢ã‚¤')
    .replace(/É”Éª/g, 'ã‚ªã‚¤')
    .replace(/aÊŠ/g, 'ã‚¢ã‚¦')
    .replace(/oÊŠ/g, 'ã‚ªã‚¦')
    .replace(/ÉªÉ™/g, 'ã‚¤ã‚¢')
    .replace(/eÉ™/g, 'ã‚¨ã‚¢')
    .replace(/ÊŠÉ™/g, 'ã‚¦ã‚¢')
    .replace(/Éª/g, 'ã‚¤')
    .replace(/iË/g, 'ã‚¤ãƒ¼')
    .replace(/ÊŠ/g, 'ã‚¦')
    .replace(/uË/g, 'ã‚¦ãƒ¼')
    .replace(/e/g, 'ã‚¨')
    .replace(/É™/g, 'ã‚¢')
    .replace(/ÉœË/g, 'ã‚¢ãƒ¼')
    .replace(/É”Ë/g, 'ã‚ªãƒ¼')
    .replace(/É’/g, 'ã‚ª')
    .replace(/[ptkbdgfvÎ¸Ã°szÊƒÊ’hmnÅ‹lrjyw]/g, function(m){
      const map = { p:'ãƒ—', t:'ãƒˆ', k:'ã‚¯', b:'ãƒ–', d:'ãƒ‰', g:'ã‚°', f:'ãƒ•', v:'ãƒ´', s:'ã‚¹', z:'ã‚º', h:'ãƒ', m:'ãƒ ', n:'ãƒ³', r:'ãƒ«', l:'ãƒ«', j:'ãƒ¤', w:'ãƒ¯', Å‹:'ãƒ³ã‚°', Êƒ:'ã‚·ãƒ¥', Ê’:'ã‚¸ãƒ¥', Î¸:'ã‚¹', Ã°:'ã‚º' };
      return map[m]||'';
    })
    .replace(/[ËˆËŒ.\/]/g,'');
}

// ãƒ¯ãƒ¼ãƒ‰ãƒ–ãƒƒã‚¯ã‚’æ§‹ç¯‰ï¼ˆSEED_BASIC + SEED_IDIOMS ã‚’åˆæˆã—ã¦ç´„800ã«ï¼‰
function buildWordBook(){
  const wb = [];
  // ã¾ãšåŸºæœ¬èªã‚’è¿½åŠ 
  for(const e of SEED_BASIC){
    const english = e;
    const japanese = JAPANESE_MAP[english]||'';
    const ipa = simpleIpa(english);
    const katakana = katakanaFromIpa(ipa);
    wb.push({ japanese, english, ipa, katakana });
  }
  // æ¬¡ã«ã‚¤ãƒ‡ã‚£ã‚ªãƒ ã‚’è¿½åŠ 
  for(const e of SEED_IDIOMS){
    const english = e;
    const japanese = JAPANESE_MAP[english]||'';
    const ipa = simpleIpa(english);
    const katakana = katakanaFromIpa(ipa);
    wb.push({ japanese, english, ipa, katakana });
  }

  // åˆè¨ˆã‚’800ã«ã™ã‚‹ãŸã‚ã€æ—¢å­˜ã®å˜èªã‚’çµ„ã¿åˆã‚ã›ã¦ãƒãƒªã‚¨ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ä½œã‚‹
  const baseLen = wb.length;
  let i = 0;
  while(wb.length < 800){
    const src = wb[i % baseLen];
    // ãƒãƒªã‚¨ãƒ¼ã‚·ãƒ§ãƒ³åã‚’ä»˜ã‘ã‚‹ï¼ˆç•ªå·ï¼‰
    const english = src.english + (Math.floor(i / baseLen) === 0 ? '' : ' ' + (Math.floor(i / baseLen)+1));
    const japanese = src.japanese ? (src.japanese + (Math.floor(i / baseLen) === 0 ? '' : ' ' + (Math.floor(i / baseLen)+1))) : '';
    const ipa = simpleIpa(src.english);
    const katakana = katakanaFromIpa(ipa);
    wb.push({ japanese, english, ipa, katakana });
    i++;
    if(i>10000) break; // å®‰å…¨ãƒ–ãƒ¬ãƒ¼ã‚¯
  }

  return wb.slice(0,800);
}

// ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ãƒ©ãƒƒãƒ‘ãƒ¼
window.storage = {
  get: async (key) => { const v = localStorage.getItem(key); return v ? { key, value: v } : null; },
  set: async (key, value) => { localStorage.setItem(key, value); return { key, value }; }
};

function FlashcardApp(){
  const [words, setWords] = useState([]);
  const [inputText, setInputText] = useState('');
  const [isStudying, setIsStudying] = useState(false);
  const [currentIndex, setCurrentIndex] = useState(0);
  const [showAnswer, setShowAnswer] = useState(false);
  const [repeatCount, setRepeatCount] = useState(0);
  const [isLoading, setIsLoading] = useState(true);
  const [isSearching, setIsSearching] = useState(false);
  const [searchResults, setSearchResults] = useState([]);

  useEffect(()=>{ init(); }, []);

  async function init(){
    try{
      const r = await window.storage.get('flashcard-words');
      if(r && r.value){
        setWords(JSON.parse(r.value));
      } else {
        const generated = buildWordBook();
        setWords(generated);
        await window.storage.set('flashcard-words', JSON.stringify(generated));
      }
    }catch(e){ console.error(e); }
    setIsLoading(false);
  }

  async function saveWords(newWords){ setWords(newWords); await window.storage.set('flashcard-words', JSON.stringify(newWords)); }

  function lookupByJapanese(query){
    const q = query.trim().toLowerCase(); if(!q) return [];
    return words.filter(w => (w.japanese||'').toLowerCase().includes(q) || (w.english||'').toLowerCase().includes(q));
  }

  async function translateToEnglish(japanese){
    const foundExact = words.find(w => w.japanese === japanese || w.english === japanese);
    if(foundExact) return foundExact;
    const foundPartial = words.find(w => (w.japanese||'').includes(japanese) || (w.english||'').includes(japanese));
    if(foundPartial) return foundPartial;
    return { japanese, english: 'ï¼ˆæœªç™»éŒ²ï¼‰', ipa: '', katakana: '' };
  }

  async function addWord(){ if(!inputText.trim()) return; const newEntry = await translateToEnglish(inputText.trim()); const updated=[...words,newEntry]; await saveWords(updated); setInputText(''); }
  async function deleteWord(idx){ const updated = words.filter((_,i)=>i!==idx); await saveWords(updated); }
  async function clearAllWords(){ if(confirm('ã™ã¹ã¦ã®å˜èªã‚’å‰Šé™¤ã—ã¾ã™ã‹ï¼Ÿï¼ˆå…ƒã«æˆ»ã›ã¾ã›ã‚“ï¼‰')) await saveWords([]); }
  function exportWords(){ const blob = new Blob([JSON.stringify(words,null,2)],{type:'application/json'}); const url = URL.createObjectURL(blob); const a=document.createElement('a'); a.href=url; a.download='flashcards_complete.json'; a.click(); URL.revokeObjectURL(url); }
  function importWords(e){ const file=e.target.files[0]; if(!file) return; const r=new FileReader(); r.onload=async(ev)=>{ try{ const imp=JSON.parse(ev.target.result); const upd=[...words,...imp]; await saveWords(upd); alert(`${imp.length} ä»¶ã‚’ã‚¤ãƒ³ãƒãƒ¼ãƒˆã—ã¾ã—ãŸ`); }catch(err){ alert('èª­ã¿è¾¼ã¿å¤±æ•—'); } }; r.readAsText(file); }

  function startStudying(){ if(words.length>0){ setIsStudying(true); setCurrentIndex(0); setShowAnswer(false); setRepeatCount(0); } }
  function handleCardClick(){ if(!showAnswer) setShowAnswer(true); else{ if(repeatCount===0){ setRepeatCount(1); setShowAnswer(false); } else{ if(currentIndex < words.length-1){ setCurrentIndex(currentIndex+1); setShowAnswer(false); setRepeatCount(0); } else { setIsStudying(false); setCurrentIndex(0); setRepeatCount(0); } } } }
  function speakWord(text){ if('speechSynthesis' in window){ speechSynthesis.cancel(); setTimeout(()=>{ const u=new SpeechSynthesisUtterance(text); u.lang='en-US'; u.rate=0.9; speechSynthesis.speak(u); },80); } }
  useEffect(()=>{ if(isStudying && !showAnswer && words[currentIndex]){ const t=setTimeout(()=>speakWord(words[currentIndex].english),300); return ()=>clearTimeout(t); } }, [isStudying,currentIndex,showAnswer]);

  if(isLoading) return (<div className="min-h-screen flex items-center justify-center">èª­ã¿è¾¼ã¿ä¸­...</div>);

  if(isStudying){ const w=words[currentIndex]; return (
    <div className="min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 flex items-center justify-center p-4">
      <div className="max-w-2xl w-full">
        <div className="text-center mb-4 text-gray-600">{currentIndex+1} / {words.length} (è¡¨ç¤º: {repeatCount+1}/2å›ç›®)</div>
        <div onClick={handleCardClick} className="bg-white rounded-2xl shadow p-12 cursor-pointer min-h-[320px] flex flex-col items-center justify-center">
          {!showAnswer ? (
            <>
              <div className="text-5xl font-bold text-indigo-600 mb-4">{w.english}</div>
              <div className="text-xl text-gray-600 mb-2 font-mono">{w.ipa}</div>
              <div className="text-2xl text-gray-500 mb-8">{w.katakana}</div>
              <button onClick={(e)=>{e.stopPropagation(); speakWord(w.english);}} className="p-4 bg-indigo-100 rounded-full">ğŸ”Š</button>
              <div className="mt-8 text-gray-400">ã‚¿ãƒƒãƒ—ã—ã¦ç­”ãˆã‚’è¡¨ç¤º</div>
            </>
          ) : (
            <>
              <div className="text-3xl text-gray-400 mb-2">{w.english}</div>
              <div className="text-lg text-gray-400 mb-4 font-mono">{w.ipa}</div>
              <div className="text-5xl font-bold text-green-600">{w.japanese || 'ï¼ˆæœªç™»éŒ²ï¼‰'}</div>
              <div className="mt-8 text-gray-400">ã‚¿ãƒƒãƒ—ã—ã¦{repeatCount===0 ? '2å›ç›®ã¸' : 'æ¬¡ã¸'}</div>
            </>
          )}
        </div>
        <button onClick={()=>{speechSynthesis.cancel(); setIsStudying(false); setCurrentIndex(0); setRepeatCount(0);}} className="mt-6 w-full py-3 bg-gray-200 rounded-lg">å­¦ç¿’ã‚’çµ‚äº†</button>
      </div>
    </div>
  ); }

  return (
    <div className="min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 p-4 sm:p-6">
      <div className="max-w-4xl mx-auto">
        <h1 className="text-3xl sm:text-4xl font-bold text-indigo-900 mb-6 text-center">ğŸ“š è‹±å˜èªãƒ•ãƒ©ãƒƒã‚·ãƒ¥ã‚«ãƒ¼ãƒ‰ï¼ˆã‚ªãƒ•ãƒ©ã‚¤ãƒ³ å®Œå…¨ç‰ˆ ç´„800èªï¼‰</h1>

        <div className="bg-white rounded-xl shadow p-4 mb-4">
          <div className="flex gap-3">
            <input type="text" value={inputText} onChange={(e)=>{ setInputText(e.target.value); setIsSearching(true); setSearchResults(lookupByJapanese(e.target.value)); }} onKeyPress={(e)=> e.key==='Enter' && addWord()} placeholder="æ—¥æœ¬èªã§æ¤œç´¢ï¼è¿½åŠ ï¼ˆä¾‹: ã‚Šã‚“ã”ã€æ™‚é–“ã‚’ã¤ã¶ã™ï¼‰" className="flex-1 px-4 py-3 border rounded-lg" />
            <button onClick={addWord} className="px-6 py-3 bg-indigo-600 text-white rounded-lg">è¿½åŠ </button>
          </div>

          {isSearching && inputText.trim() && (
            <div className="mt-3 text-sm text-gray-700">
              æ¤œç´¢çµæœï¼š{searchResults.length} ä»¶
              <div className="mt-2 space-y-2">
                {searchResults.slice(0,10).map((r,i)=> (
                  <div key={i} className="p-2 bg-gray-50 rounded flex items-center justify-between">
                    <div>
                      <div className="font-bold">{r.japanese || 'ï¼ˆæœªç™»éŒ²ï¼‰'} â€” {r.english}</div>
                      <div className="text-xs font-mono">{r.ipa} {r.katakana}</div>
                    </div>
                    <div>
                      <button className="text-sm mr-2" onClick={()=>{ navigator.clipboard && navigator.clipboard.writeText(JSON.stringify(r)); alert('ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸ'); }}>ã‚³ãƒ”ãƒ¼</button>
                      <button className="text-sm text-red-500" onClick={()=>{ if(confirm('å‰Šé™¤ã—ã¾ã™ã‹ï¼Ÿ')) deleteWord(words.indexOf(r)); }}>å‰Šé™¤</button>
                    </div>
                  </div>
                ))}
              </div>
            </div>
          )}

        </div>

        {words.length>0 && (
          <>
            <button onClick={startStudying} className="w-full mb-4 py-4 bg-green-600 text-white rounded-xl font-bold">ğŸ“– å­¦ç¿’ã‚¹ã‚¿ãƒ¼ãƒˆ ({words.length} å˜èª)</button>

            <div className="flex flex-wrap gap-2 mb-4">
              <button onClick={exportWords} className="py-2 px-4 bg-blue-500 text-white rounded">ğŸ’¾ ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ</button>
              <label className="py-2 px-4 bg-green-500 text-white rounded cursor-pointer">ğŸ“¤ ã‚¤ãƒ³ãƒãƒ¼ãƒˆ <input type="file" accept=".json" onChange={importWords} className="hidden" /></label>
              <button onClick={clearAllWords} className="py-2 px-4 bg-red-500 text-white rounded">ğŸ—‘ï¸ å…¨å‰Šé™¤</button>
            </div>

            <div className="bg-white rounded-xl shadow p-4">
              <h2 className="text-lg font-bold mb-4">ç™»éŒ²æ¸ˆã¿å˜èª</h2>
              <div className="space-y-3">
                {words.map((w, idx)=> (
                  <div key={idx} className="flex items-center justify-between p-3 bg-gray-50 rounded">
                    <div className="min-w-0 mr-3">
                      <div className="font-bold text-indigo-600 truncate">{w.english}</div>
                      <div className="text-xs font-mono">{w.ipa}</div>
                      <div className="text-xs">{w.katakana}</div>
                    </div>
                    <div className="flex items-center gap-2">
                      <div className="text-sm">{w.japanese || 'ï¼ˆæœªç™»éŒ²ï¼‰'}</div>
                      <button onClick={()=>deleteWord(idx)} className="p-2 text-red-500">ğŸ—‘ï¸</button>
                    </div>
                  </div>
                ))}
              </div>
            </div>
          </>
        )}

        {words.length===0 && (
          <div className="text-center text-gray-500 mt-12">
            <div className="text-6xl mb-4">ğŸ“š</div>
            <p>ã¾ã å˜èªãŒç™»éŒ²ã•ã‚Œã¦ã„ã¾ã›ã‚“</p>
            <p className="text-sm mt-2">æ—¥æœ¬èªã‚’å…¥åŠ›ã—ã¦å˜èªã‚’è¿½åŠ ã—ã¾ã—ã‚‡ã†ï¼</p>
          </div>
        )}

      </div>
    </div>
  );
}

ReactDOM.render(<FlashcardApp />, document.getElementById('root'));

</script>
</body>
</html>
